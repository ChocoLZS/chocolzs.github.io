---
title: Alsï¼ˆç›´æ’­/å›æ”¾ï¼‰åŠ¨æ•æ•°æ®ä¼ è¾“ç»“æ„åˆ†æ
series:
  order: 2
  title: 'Linkï¼Likeï¼-åŠ¨æ•æ•°æ®-als'
date: '2025-08-07'
lastmod: '2025-08-17'
language: zh
tags: ['é€†å‘', 'linkura', 'Link!Like!', 'lovelive', 'protobuf', 'æ‰‹æ¸¸', 'äºŒæ¬¡å…ƒ', 'ACGN']
authors: ['choco']
draft: false
wip: false
featured: true
summary: è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯æ€»ç»“æ—åº“æ‹‰ï¼ˆLinkuraï¼‰ç›´æ’­/å›æ”¾åŠ¨æ•æ•°æ®ä¼ è¾“çš„ç»“æ„ã€‚
---

## çœæµ

ä½¿ç”¨äº† **protobuf** è¿›è¡Œæ•°æ®åºåˆ—åŒ–ã€‚

æœ¬æ–‡åªåˆ†æä»æœåŠ¡ç«¯è·å–çš„æ•°æ®ï¼Œä»å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ä¸åœ¨æ­¤å¤„åˆ†æã€‚

æœ¬æ–‡ä½¿ç”¨äº†[ç¬”è€…ç¼–å†™çš„å·¥å…·](https://github.com/ChocoLZS/linkura-cli/releases/tag/linkura-motion-cli-v1.0.0)è¿›è¡Œåˆ†æï¼Œå…¶å®ç®—æ˜¯å¯¹æ•°æ®åŒ…ç»“æ„çš„æ€»ç»“ï¼Œè€Œä¸æ˜¯é€†å‘åˆ†æçš„å¤ç›˜ã€‚

æ€»ç»“[ç‚¹è¿™é‡ŒğŸ«²](#æ€»ç»“)

## å‰è¨€

æ€»æ‰€å‘¨çŸ¥ï¼ˆï¼‰ï¼ŒLinkuraåœ¨25å¹´5æœˆ29æ—¥çš„ç›´æ’­ä¸Šä½¿ç”¨äº†æ–°çš„åŠ¨æ•å›æ”¾ï¼Œç›¸è¾ƒä¹‹å‰ä½¿ç”¨[monobitinc](https://www.monobitengine.com/mrs/)å®¶çš„mrsæŠ€æœ¯ï¼Œç›´æ’­ç›¸å¯¹æ¥è¯´æ›´åŠ ç¨³å®šæµç•…äº†ã€‚

å®é™…wiresharkæŠ“åŒ…æµ‹è¯•ï¼Œä½“éªŒä¸Šæ˜¯å°†æ›´å¤šå°åŒ…æ‹¼æ¥æˆå¤§åŒ…æ¥è¿›è¡Œtcpå‘é€ï¼Œå‡å°‘äº†ä¸¢å°åŒ…çš„æ•°é‡ã€‚ï¼ˆå› ä¸ºå¦‚æœä¸¢åŒ…æ˜¯ç›´æ¥ä¸¢å¤§åŒ…ï¼ˆç¬‘ï¼‰ï¼‰

å…³äºcdnä¸Šå­˜æ”¾çš„å›æ”¾æ–‡ä»¶æ ¼å¼ï¼š

- æä¾›äº†.mdæ–‡ä»¶ï¼ˆä¸€å¼€å§‹ä»¥ä¸ºæ˜¯markdownï¼Œå†™æ­¤ç‰‡æ–‡ç« æ—¶è®¤ä¸ºæ˜¯metadataï¼‰ä½œä¸ºä¸€å¼€å§‹çš„å…ƒä¿¡æ¯æè¿°æ–‡ä»¶ã€‚

- å€Ÿç”¨äº†æµåª’ä½“ç›¸å…³çš„hlsæŠ€æœ¯ï¼Œä½¿ç”¨äº† **m3u8** è¿›è¡Œåˆ‡ç‰‡ï¼Œæ¯ä¸ªåˆ†ç‰‡æ˜¯.tsæ–‡ä»¶ï¼Œä½†å®ƒä¸æ˜¯ **MPEG-TS**ï¼Œæ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚

ä¼°è®¡alsè¿™å®¶å…¬å¸æ˜¯å€Ÿç”¨hlsè¿™ä¸€å¥—è®¾è®¡ï¼Œä¸€æ–¹é¢å€Ÿç”¨cdnç›¸å…³åŸºç¡€è®¾æ–½ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯èƒ½æ˜¯ä¸ºäº†å…¼å®¹ç°æœ‰çš„è§†é¢‘æµå›æ”¾æ’­æ”¾æ–¹æ¡ˆã€‚

## protobuf

å…·ä½“åŒ…ç±»å‹ä¹Ÿå¯ä»¥åœ¨ Alstromeria.dll Alst.Protocol ä¸­çš„
`DataPack`ã€`DataFrame`ä¸­æ‰¾åˆ°

```protobuf datapack.proto
package als;

message DataPack
{
	oneof control
{
	bool data = 2;
	bool pong = 10; // ç›´æ’­ä¼šä½¿ç”¨
	int64 segment_started_at = 14;
	bool cache_ended = 15;
}
	repeated .als.DataFrame frames = 16;
}

message DataFrame
{
	oneof message
{
	.als.InstantiateObject instantiate_object = 128;
	.als.UpdateObject update_object = 129;
	.als.Room room = 143;
	.als.AuthorizeResponse authorize_response = 144;    // ç›´æ’­
	.als.JoinRoomResponse join_room_response = 147;     // ç›´æ’­
}
}

```

## å›æ”¾æ•°æ®

ç”±äºå›æ”¾æ•°æ®ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå¥½è·å–ï¼Œæ‰€ä»¥å…ˆä»‹ç»å›æ”¾æ•°æ®çš„ç»“æ„ã€‚

æ¥ä¸‹æ¥ä»¥ 25-07-31 ï¼Œå°ä¸‰è§’ç»™ç²‰ä¸æŠ•ç¨¿çš„ç‰©å“å‘½åè¿™é›†ä¸ºä¾‹ã€‚

### æ•°æ®åŒ…æ ¼å¼

```c
struct Packet {
  uint16_t length;                  // å¤§ç«¯åºï¼ŒåŒ…é•¿åº¦ï¼šlive_mark + microseconds + protobuf_data
  uint8_t live_mark;                // 0 ä»£è¡¨ç›´æ’­ 1 ä»£è¡¨å›æ”¾ å›æ”¾è¿™é‡Œä¸€ç›´æ˜¯ 0x01
  uint64_t microseconds;            // å¤§ç«¯åºï¼Œå¾®ç§’æ—¶é—´æˆ³
  uint8_t protobuf_data[];          // é•¿åº¦ä¸º length - 1 - 8
}
```

### æ•°æ®ä»‹ç»

#### `811c9dc5b61ac_segment00000.ts` åˆ†ç‰‡ç»“æ„åˆ†æ

##### æ•°æ®åŒ…æ€»ç»“

```
================== STATISTICS ==================
Total packets analyzed: 596
Packets with control messages: 596 (100.0%)
Packets with frames: 594 (99.7%)
Total frames: 2712

Control Message Types:
  Data: 594 (99.7%)
  SegmentStartedAt: 1 (0.2%)
  CacheEnded: 1 (0.2%)
  Total Control Messages: 596

Frame Message Types:
  Object Messages:
    InstantiateObject: 55 (2.0%)
    UpdateObject: 2655 (97.9%)
  Room: 2 (0.1%)
  Total Frame Messages: 2712
================================================
```

åˆå§‹åŒ–00 tsåˆ†ç‰‡å‰å‡ ä¸ªåŒ…ç”±å¦‚ä¸‹ç»“æ„æ„æˆï¼š

1. SegmentStartedAt
2. Data-Room
3. CacheEnded
4. Data-Frames(InstantiateObject|UpdateObject)
5. è‹¥å¹²Data-Frames(UpdateObject)

##### SegmentStartedAt

```
=== Packet #1: 18 bytes ===
  Format: Standard protobuf format (int16 length + int8 unused + int64 timestamp + protobuf data)
  Timestamp: 2025-07-31 11:20:00.753128 UTC (1753960800753128)
  Raw data length: 9 bytes
  Raw data (first 9 bytes): 70 e8 ab ea 93 fd e6 8e 03
  Protobuf Fields:
    Field #14: Varint (wire type: 0, 9 bytes)
      Raw bytes: 70 e8 ab ea 93 fd e6 8e 03
  Control message:
    Type: SegmentStartedAt, Timestamp: 1753960800753128
  No frames
```

åˆ†ç‰‡å¼€å§‹æ¸²æŸ“çš„å¾®ç§’çº§æ—¶é—´æˆ³ï¼Œæ¨ªå‘å¯¹æ¯”åˆ†ç‰‡ 01ã€02ã€03ã€04ã€05
å¯ä»¥å‘ç°åˆ†ç‰‡æŒç»­æ—¶é—´æ˜¯10ç§’ï¼Œä¸m3u8é‡Œçš„æè¿°ä¸€è‡´ï¼ˆ#EXTINF:10.000ï¼‰ã€‚

| åºå· | æ—¶é—´ |
|---|----|
| 00 | 2025-07-31 11:20:00.753128 UTC (1753960800753128) |
| 01 | 2025-07-31 11:20:10.753128 UTC (1753960810753128) |
| 02 | 2025-07-31 11:20:20.753128 UTC (1753960820753128) |
| 03 | 2025-07-31 11:20:30.753128 UTC (1753960830753128) |
| 04 | 2025-07-31 11:20:40.753128 UTC (1753960840753128) |

##### Data-Room

```
=== Packet #2: 72 bytes ===
  Format: Standard protobuf format (int16 length + int8 unused + int64 timestamp + protobuf data)
  Timestamp: 2025-07-31 11:20:40.765541 UTC (1753960840765541)
  Raw data length: 63 bytes
  Raw data (first 32 bytes): 82 01 3a fa 08 37 0a 2c 64 65 66 61 75 6c 74 2d 32 35 64 31 65 65 35 66 2d 62 36 36 35 2d 34 61
  Protobuf Fields:
    Field #16: Length-delimited (wire type: 2, 61 bytes)
      Raw bytes: 82 01 3a fa 08 37 0a 2c 64 65 66 61 75 6c 74 2d 32 35 64 31 65 65 35 66 2d 62 36 36 35 2d 34 61 39 63 2d 38 33 63 32 2d 38 34 66 30 32 39 37 62 31 35 34 62 10 f5 af aa a1 fc e5 8e 03
    Field #2: Varint (wire type: 0, 2 bytes)
      Raw bytes: 10 01
  Control message:
    Type: Data, Value: true
  Frames (1):
    Frame #1: 
      Message: Room (id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b", started: 1753926200891381, ended: 0)
```

started æ—¶é—´æ˜¯ 2025-07-31T01:43:20.891Z ç›®å‰æ²¡æ‰¾åˆ°ä»€ä¹ˆæ¥æºï¼Œ`get_archive_list` æ— æ³•è·å–åˆ°ç›¸å…³ä¿¡æ¯ã€‚

##### CacheEnded

```
=== Packet #3: 11 bytes ===
  Format: Standard protobuf format (int16 length + int8 unused + int64 timestamp + protobuf data)
  Timestamp: 2025-07-31 11:20:00.753128 UTC (1753960800753128)
  Raw data length: 2 bytes
  Raw data (first 2 bytes): 78 01
  Protobuf Fields:
    Field #15: Varint (wire type: 0, 2 bytes)
      Raw bytes: 78 01
  Control message:
    Type: CacheEnded, Value: true
  No frames
```

##### Data-Frames(InstantiateObject|UpdateObject)

```
=== Packet #4: 11780 bytes ===
  Format: Standard protobuf format (int16 length + int8 unused + int64 timestamp + protobuf data)
  Timestamp: 2025-07-31 11:20:00.753128 UTC (1753960800753128)
  Raw data length: 11771 bytes
  Raw data (first 32 bytes): 82 01 3a fa 08 37 0a 2c 64 65 66 61 75 6c 74 2d 32 35 64 31 65 65 35 66 2d 62 36 36 35 2d 34 61
  Protobuf Fields:
  ...
  Control message:
    Type: Data, Value: true
  Frames (95):
    Frame #1: 
      Message: Room (id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b", started: 1753926200891381, ended: 0)
    InstantiateObject... Owner ID: "sys" Target: RoomAll (room_id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b")
    UpdateObject... Target: RoomAll (room_id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b")
```

Owner ID: "sys"
Target: RoomAll (room_id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b")

##### è‹¥å¹²Data-Frames(UpdateObject)

```
=== Packet #5: 1958 bytes ===
  Format: Standard protobuf format (int16 length + int8 unused + int64 timestamp + protobuf data)
  Timestamp: 2025-07-31 11:20:00.759993 UTC (1753960800759993)
  Raw data length: 1949 bytes
  Raw data (first 32 bytes): 82 01 5d 8a 08 5a 40 b3 c1 83 f1 02 48 01 52 20 00 00 00 00 00 00 00 00 dd bd f4 3e e2 d9 ad 3c
  Protobuf Fields:
  ...
  Control message:
    Type: Data, Value: true
  Frames (4):
    UpdateObject... Target: RoomAll (room_id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b")
```

#### 01åˆ†ç‰‡ç»“æ„åˆ†æ

```
================== STATISTICS ==================
Total packets analyzed: 591
Packets with control messages: 590 (99.8%)
Packets with frames: 589 (99.7%)
Total frames: 2705

Control Message Types:
  Data: 588 (99.7%)
  SegmentStartedAt: 1 (0.2%)
  CacheEnded: 1 (0.2%)
  Total Control Messages: 590

Frame Message Types:
  Object Messages:
    InstantiateObject: 55 (2.0%)
    UpdateObject: 2649 (97.9%)
  Room: 1 (0.0%)
  Total Frame Messages: 2705
================================================
```

ä¸00æœ‰åŒºåˆ«

1. SegmentStartedAt ğŸ‘ˆ ç›¸æ¯”äº00 è¿‡äº†10ç§’
2. Data-Room ä¸00çš„åŒ…ç›¸åŒ
3. Data-Frames(InstantiateObject|UpdateObject)  ğŸ‘ˆ Target: CurrentPlayer, å°‘äº†ä¸ªRoom
4. CacheEnded ğŸ‘ˆ ä¿æŒä¸€è‡´
5. è‹¥å¹²Data-Frames(UpdateObject) æ²¡æœ‰å˜åŒ–

**116åˆ†ç‰‡ç»Ÿè®¡ä¿¡æ¯**

```
================== STATISTICS ==================
Total packets analyzed: 540
Packets with control messages: 539 (99.8%)
Packets with frames: 538 (99.6%)
Total frames: 2725

Control Message Types:
  Data: 537 (99.6%)
  SegmentStartedAt: 1 (0.2%)
  CacheEnded: 1 (0.2%)
  Total Control Messages: 539

Frame Message Types:
  Object Messages:
    InstantiateObject: 55 (2.0%)
    UpdateObject: 2669 (97.9%)
  Room: 1 (0.0%)
  Total Frame Messages: 2725
================================================
```

**233åˆ†ç‰‡ç»Ÿè®¡ä¿¡æ¯**

```
================== STATISTICS ==================
Total packets analyzed: 590
Packets with control messages: 589 (99.8%)
Packets with frames: 588 (99.7%)
Total frames: 2688

Control Message Types:
  Data: 587 (99.7%)
  SegmentStartedAt: 1 (0.2%)
  CacheEnded: 1 (0.2%)
  Total Control Messages: 589

Frame Message Types:
  Object Messages:
    InstantiateObject: 55 (2.0%)
    UpdateObject: 2632 (97.9%)
  Room: 1 (0.0%)
  Total Frame Messages: 2688
================================================
```

ä¸01åˆ†ç‰‡ç»“æ„ç›¸åŒ

#### åˆ†ç‰‡æ€»ç»“

åˆ†ç‰‡æ€»çš„æ¥è¯´åˆ†ä¸ºä¸¤ç§
1. æœ€åˆåˆå§‹åŒ–åˆ†ç‰‡
2. åç»­çš„æ•°æ®åˆ†ç‰‡

æŠ“åŒ…æµ‹è¯•æ—¶ï¼Œæ’­æ”¾å™¨å®é™…è·å–åˆ†ç‰‡çš„è¡Œä¸ºæ˜¯ï¼š

è·å–00ã€01ã€03åˆ†ç‰‡ï¼Œç„¶åå†æ ¹æ® `æœ¬ç·¨é–‹å§‹ "play_time_second": seconds` æ¥æŸ¥æ‰¾åç§»é‡ï¼Œè·å–ç›®æ ‡åˆ†ç‰‡ã€‚

## ç›´æ’­æ•°æ®

ç›´æ’­æ•°æ®æ˜¯é€šè¿‡[ç¬”è€…ç¼–å†™çš„å·¥å…·](https://github.com/ChocoLZS/linkura-cli/releases/tag/linkura-motion-cli-v1.0.0)è·å–çš„

åŒæ ·ä»¥ 25-07-31 ï¼Œå°ä¸‰è§’ç»™ç²‰ä¸æŠ•ç¨¿çš„ç‰©å“å‘½åè¿™é›†ä¸ºä¾‹ã€‚

### æ•°æ®åŒ…æ ¼å¼

```c
struct Packet {
  uint16_t length;                  // å¤§ç«¯åºï¼ŒåŒ…é•¿åº¦ï¼šlive_mark + protobuf_data
  uint8_t live_mark;                // 0 ä»£è¡¨ç›´æ’­ 1 ä»£è¡¨å›æ”¾ ç›´æ’­è¿™é‡Œä¸€ç›´æ˜¯ 0x00
  uint8_t protobuf_data[];          // é•¿åº¦ä¸º length - 1
}
```

å¯ä»¥çœ‹è§æ•°æ®ä¸­å¹¶æœªæºå¸¦æ—¶é—´æˆ³
æ‰€ä»¥å·¥å…·åˆè¡¥äº†ä¸€ä¸ªæ—¶é—´æˆ³

```c
struct TimestampPacket {
  uint16_t length;
  uint64_t microseconds;
}
```

å·¥å…·ä¿å­˜çš„äºŒè¿›åˆ¶ä¸ºè‹¥å¹² Packet + TimestampPacket

### æ•°æ®ä»‹ç»

#### åˆå§‹åˆ†ç‰‡ç»“æ„åˆ†æ

##### æ•°æ®åŒ…æ€»ç»“

```
================== STATISTICS ==================
Total packets analyzed: 450
Packets with control messages: 450 (100.0%)
Packets with frames: 445 (98.9%)
Total frames: 2049

Control Message Types:
  Data: 445 (98.9%)
  Pong: 5 (1.1%)
  Total Control Messages: 450

Frame Message Types:
  Response Messages:
    AuthorizeResponse: 1 (0.0%)
    JoinRoomResponse: 1 (0.0%)
  Object Messages:
    InstantiateObject: 55 (2.7%)
    UpdateObject: 1991 (97.2%)
  Room: 1 (0.0%)
  Total Frame Messages: 2049
================================================
```

æ¡æ‰‹åˆ†ç‰‡å‰å‡ ä¸ªåŒ…ç”±å¦‚ä¸‹ç»“æ„æ„æˆï¼š

1. AuthorizeResponse
2. Data-Room
3. JoinRoomResponse
4. Data-Frames(InstantiateObject|UpdateObject)
5. è‹¥å¹²Data-Frames(UpdateObject)
6. è‹¥å¹²PongåŒ…

##### AuthorizeResponse

å¯¹äºè½¬æ¢æ¥è¯´ä¸é‡è¦ï¼Œå°±æ˜¯æ­£å¸¸çš„æ¡æ‰‹æµç¨‹

##### Data-Room

```
=== Packet #3: 64 bytes ===
  Format: Mixed protobuf format (int16 length 64 + int8 unused 0x00 + protobuf data)
  Raw data length: 63 bytes
  Raw data (first 32 bytes): 82 01 3a fa 08 37 0a 2c 64 65 66 61 75 6c 74 2d 32 35 64 31 65 65 35 66 2d 62 36 36 35 2d 34 61
  Protobuf Fields:
    Field #16: Length-delimited (wire type: 2, 61 bytes)
      Raw bytes: 82 01 3a fa 08 37 0a 2c 64 65 66 61 75 6c 74 2d 32 35 64 31 65 65 35 66 2d 62 36 36 35 2d 34 61 39 63 2d 38 33 63 32 2d 38 34 66 30 32 39 37 62 31 35 34 62 10 f5 af aa a1 fc e5 8e 03
    Field #2: Varint (wire type: 0, 2 bytes)
      Raw bytes: 10 01
  Control message:
    Type: Data, Value: true
  Frames (1):
    Frame #1: 
      Message: Room (id: "default-25d1ee5f-b665-4a9c-83c2-84f0297b154b", started: 1753926200891381, ended: 0)
```

âœ… ä¸å›æ”¾ç›¸åŒ

##### JoinRoomResponse

ä¸é‡è¦ï¼Œå°±æ˜¯æ­£å¸¸çš„æ¡æ‰‹æµç¨‹

##### Data-Frames(InstantiateObject|UpdateObject)

```
=== Packet #7: 7997 bytes ===
  Format: Mixed protobuf format (int16 length 7997 + int8 unused 0x00 + protobuf data)
  Raw data length: 7996 bytes
  Raw data (first 32 bytes): 82 01 44 82 08 41 40 9c 82 a2 c3 04 4a 0c 61 75 64 69 65 6e 63 65 2d 70 6f 64 52 1e e9 ff ff ff
  Protobuf Fields:
  ...
  Control message:
    Type: Data, Value: true
  Frames (94):
    InstantiateObject... Owner ID: "audience-pod" Target: RoomAll (room_id: "")
    UpdateObject... Target: RoomAll (room_id: "")
```

InstantiateObject idï¼Œæ•°é‡ä¸ å›æ”¾ä¸€è‡´ã€‚ä¸ä¸€æ ·çš„å°±æ˜¯ Owner ID å’Œ Target Room IDã€‚
UpdateObject Target Room ID ä¸ºç©º

##### è‹¥å¹²Data-Frames(UpdateObject)

```
=== Packet #13: 1816 bytes ===
  Format: Mixed protobuf format (int16 length 1816 + int8 unused 0x00 + protobuf data)
  Raw data length: 1815 bytes
  Raw data (first 32 bytes): 82 01 2f 8a 08 2c 40 b3 c1 83 f1 02 48 01 52 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  Protobuf Fields:
  ...
  Control message:
    Type: Data, Value: true
  Frames (4):
    UpdateObject... Target: RoomAll (room_id: "")
```

##### è‹¥å¹²PongåŒ…

å¯¹äºå›æ”¾æ¥è¯´ä¸é‡è¦ï¼Œç›´æ’­ç”¨äºæ£€æµ‹å¿ƒè·³ç”¨çš„

#### åç»­åˆ†ç‰‡åˆ†æ

```
================== STATISTICS ==================
Total packets analyzed: 450
Packets with control messages: 450 (100.0%)
Packets with frames: 445 (98.9%)
Total frames: 1974

Control Message Types:
  Data: 445 (98.9%)
  Pong: 5 (1.1%)
  Total Control Messages: 450

Frame Message Types:
  Object Messages:
    UpdateObject: 1974 (100.0%)
  Total Frame Messages: 1974
================================================
```

ç†è®ºä¸Šæ¥è¯´ç›®å‰ç›´æ’­æ²¡æœ‰åç»­åˆ†ç‰‡çš„è¯´æ³•ï¼Œæ— æ³•æº¯æº+æ‹–åŠ¨è¿›åº¦æ¡
åªæœ‰ UpdateObject å’Œ Pong åŒ…

ç»“æŸçš„åˆ†ç‰‡
```
================== STATISTICS ==================
Total packets analyzed: 308
Packets with control messages: 308 (100.0%)
Packets with frames: 193 (62.7%)
Total frames: 594

Control Message Types:
  Data: 193 (62.7%)
  Pong: 115 (37.3%)
  Total Control Messages: 308

Frame Message Types:
  Object Messages:
    UpdateObject: 576 (97.0%)
    DestroyObject: 18 (3.0%)
  Total Frame Messages: 594
================================================
```

æœ‰DestroyObjectæŒ‡ä»¤ï¼Œçœ‹äº†å‰åçš„åŒ…ï¼ŒåŸºæœ¬éƒ½æ˜¯PongåŒ…ã€‚

å¯ä»¥æ¨æµ‹æ˜¯æœåŠ¡å™¨å…³é—­ååšçš„finalizeç›¸å…³çš„æ“ä½œã€‚

## æ€»ç»“

é€šè¿‡å¯¹æ¯”ç›´æ’­å’Œå›æ”¾çš„æ•°æ®åŒ…ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä»¥ä¸‹å¼‚åŒç‚¹ï¼š

<table className="[&_tbody_tr_td]:px-2 [&_tbody_tr_th]:px-2 [&_tbody_tr]:border-b [&_tbody_*]:align-middle">
<caption>æ€»ç»“å¤§è¡¨</caption>
<tbody>
<tr>
  <th width="75">é¡¹ç›®</th>
  <th width="150">ç›´æ’­æ•°æ®</th>
  <th width="150">å›æ”¾æ•°æ®</th>
  <th>ç›¸åŒè¯´æ˜</th>
  <th>å·®å¼‚è¯´æ˜</th>
</tr>
{/* åŒ…ç»“æ„ */}
<tr>
  <td rowSpan={3}>åŒ…ç»“æ„</td>
  <td colSpan={2} className='text-center'>uint16_t length <br/> uint8_t live_mark</td>
  <td >length: 2å­—èŠ‚ï¼Œå¤§ç«¯åº <br/> mark: 1å­—èŠ‚æ ‡è®°</td>
  <td >live_markï¼š<br />ç›´æ’­æ˜¯ 0x00ï¼Œå›æ”¾æ˜¯ 0x01</td>
</tr>
<tr>
  <td></td>
  <td>**uint64_t timestamp**</td>
  <td></td>
  <td>å›æ”¾æºå¸¦äº†å¾®ç§’æ—¶é—´æˆ³</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>protobuf</td>
</tr>
{/* åŒ…ç»“æ„ç»“æŸ */}
{/* åˆå§‹åˆ†ç‰‡ */}
<tr>
  <td rowSpan={8}>åˆå§‹åˆ†ç‰‡ protobuf</td>
  <td>AuthorizeResponse</td>
  <td>SegmentStartedAt</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>Data-Room</td>
  <td> Room: live id, started, ended ç›¸åŒ </td>
</tr>
<tr>
  <td>JoinRoomResponse</td>
  <td>CacheEnded</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>Data-Frames</td>
</tr>
<tr>
  <td></td>
  <td>**Data-Room**</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>(InstantiateObject|UpdateObject)</td>
  <td>InstantiateObjectæ•°é‡ï¼Œidç›¸åŒ<br/> UpdateObjectåˆå§‹åŒ–æ•°æ®ä¹Ÿç›¸åŒ</td>
  <td>InstantiateObjectçš„Owner ID: <br /> ç›´æ’­: "audience-pod"<br /> å›æ”¾: "sys"<br /><br />Target:<br /> ç›´æ’­: RoomAll (room_id: "")<br />å›æ”¾ï¼šRoomAll (room_id: "default-xxx...")</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>è‹¥å¹²Data-Frames(UpdateObject)</td>
  <td></td>
  <td>Target:<br /> ç›´æ’­: RoomAll (room_id: "")<br />å›æ”¾ï¼šRoomAll (room_id: "default-xxx...")</td>
</tr>
<tr>
  <td>**è‹¥å¹²PongåŒ…**</td>
</tr>
{/* åˆå§‹åˆ†ç‰‡ç»“æŸ */}
{/* åç»­åˆ†ç‰‡ */}
<tr>
  <td rowSpan={9}>åç»­åˆ†ç‰‡ protobuf</td>
  <td className='text-center font-bold'>å›æ”¾åˆå§‹åˆ†ç‰‡</td>
  <td className='text-center font-bold'>å›æ”¾åç»­åˆ†ç‰‡</td>
  <td rowSpan={2}></td>
  <td rowSpan={2}></td>
</tr>
<tr>
  <td colSpan={2} className='text-center text-xs text-zinc-500'>ç›´æ’­æµæ²¡æœ‰åç»­åˆ†ç‰‡çš„è¯´æ³•ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæ¯”è¾ƒå›æ”¾çš„åˆå§‹åˆ†ç‰‡å’Œåç»­åˆ†ç‰‡</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>SegmentStartedAt</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>Data-Room</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>Data-Frames</td>
</tr>
<tr>
  <td>**Data-Room**</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>(InstantiateObject|UpdateObject)</td>
  <td>InstantiateObjectæ•°é‡ï¼Œidç›¸åŒ<br/> UpdateObjectåˆå§‹åŒ–æ•°æ®ä¹Ÿç›¸åŒ</td>
  <td>Target: <br/>ç›´æ’­åˆ†ç‰‡: RoomAll (room_id: "default-xxx...")<br/>åç»­åˆ†ç‰‡: CurrentPlayer</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>CacheEnded</td>
</tr>
<tr>
  <td colSpan={2} className='text-center'>è‹¥å¹²Data-Frames(UpdateObject)</td>
  <td>Target: RoomAll (room_id: "default-xxx...")</td>
  <td></td>
</tr>
{/* åç»­åˆ†ç‰‡ç»“æŸ */}
</tbody>
</table>

### è¯¦ç»†æŠ€æœ¯å·®å¼‚åˆ†æ Generated By Claude Sonnet 4

#### Protobufå­—æ®µä½¿ç”¨å¯¹æ¯”

| Fieldç¼–å· | å­—æ®µåç§° | ç›´æ’­ä½¿ç”¨ | å›æ”¾ä½¿ç”¨ | ç”¨é€”è¯´æ˜ |
|----------|----------|----------|----------|----------|
| **Field #2** | data | âœ… é¢‘ç¹ä½¿ç”¨ | âœ… é¢‘ç¹ä½¿ç”¨ | æ ‡è¯†æ•°æ®åŒ… |
| **Field #10** | pong | âœ… å¿ƒè·³æ£€æµ‹ | âŒ ä¸ä½¿ç”¨ | ç›´æ’­ä¸“ç”¨å¿ƒè·³ |
| **Field #14** | segment_started_at | âŒ ä¸ä½¿ç”¨ | âœ… æ¯åˆ†ç‰‡1æ¬¡ | åˆ†ç‰‡æ—¶é—´æˆ³ |
| **Field #15** | cache_ended | âŒ ä¸ä½¿ç”¨ | âœ… æ¯åˆ†ç‰‡1æ¬¡ | ç¼“å­˜ç»“æŸæ ‡è®° |
| **Field #16** | frames | âœ… ä¸»è¦è½½è· | âœ… ä¸»è¦è½½è· | å¸§æ•°æ®æ•°ç»„ |

#### å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†å¯¹æ¯”

| ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ | ç›´æ’­å¤„ç† | å›æ”¾å¤„ç† | æŠ€æœ¯ç»†èŠ‚ |
|-------------|----------|----------|----------|
| **å¯¹è±¡åˆ›å»º** | InstantiateObject (55ä¸ª) | InstantiateObject (55ä¸ª) | æ•°é‡å’ŒIDå®Œå…¨ç›¸åŒ |
| **å¯¹è±¡æ›´æ–°** | è¿ç»­UpdateObjectæµ | æŒ‰åˆ†ç‰‡UpdateObject | ç›´æ’­å®æ—¶ï¼Œå›æ”¾åˆ†æ®µ |
| **å¯¹è±¡é”€æ¯** | DestroyObject (ç»“æŸæ—¶) | âŒ æ— æ˜¾å¼é”€æ¯ | ç›´æ’­éœ€è¦æ¸…ç†èµ„æº |
| **Owneræ ‡è¯†** | "audience-pod" | "sys" | æƒé™å’Œæ¥æºä¸åŒ |

#### æ—¶é—´åŒæ­¥æœºåˆ¶å¯¹æ¯”

| æ—¶é—´ç»´åº¦ | ç›´æ’­å®ç° | å›æ”¾å®ç° | ç²¾åº¦å·®å¼‚ |
|----------|----------|----------|----------|
| **åŒ…çº§æ—¶é—´æˆ³** | âŒ æ— å†…ç½® | âœ… å¾®ç§’çº§ | å›æ”¾å¯ç²¾ç¡®å®šä½ |
| **åˆ†ç‰‡æ—¶é—´æˆ³** | âŒ æ— åˆ†ç‰‡æ¦‚å¿µ | âœ… 10ç§’é—´éš” | å›æ”¾æ”¯æŒè·³è½¬ |
| **Room started** | 1753926200891381 | 1753926200891381 | å®Œå…¨ç›¸åŒçš„èµ·å§‹æ—¶é—´ |
| **æ—¶åºä¿è¯** | ç½‘ç»œä¼ è¾“é¡ºåº | æ—¶é—´æˆ³æ’åº | å›æ”¾å¯é‡æ’åº |

#### åˆ†ç‰‡ç­–ç•¥è¯¦ç»†å¯¹æ¯”

| åˆ†ç‰‡ç‰¹å¾ | ç›´æ’­æ¨¡å¼ | å›æ”¾æ¨¡å¼ | å®ç°å¤æ‚åº¦ |
|----------|----------|----------|------------|
| **åˆå§‹åŒ–åˆ†ç‰‡** | âŒ æ— æ¦‚å¿µ | âœ… å®Œæ•´çŠ¶æ€ | å›æ”¾éœ€è¦çŠ¶æ€é‡å»º |
| **åç»­åˆ†ç‰‡** | âŒ æ— æ¦‚å¿µ | âœ… å¢é‡æ›´æ–° | å›æ”¾æ”¯æŒéšæœºè®¿é—® |
| **åˆ†ç‰‡å¤§å°** | N/A | ~540-596åŒ… | å›ºå®šæ—¶é•¿åˆ†ç‰‡ |
| **overlapå¤„ç†** | N/A | åˆ†ç‰‡é—´çŠ¶æ€ä¸€è‡´ | éœ€è¦çŠ¶æ€ç®¡ç† |

#### å›æ”¾åˆ†ç‰‡å†…éƒ¨ç»“æ„å¯¹æ¯”

| é¡¹ç›® | åˆå§‹åˆ†ç‰‡ (00) | åç»­åˆ†ç‰‡ (01+) | å·®å¼‚è¯´æ˜ |
|------|---------------|----------------|----------|
| **åŒ…åºåˆ—ç»“æ„** | SegmentStartedAt â†’ Data-Room â†’ CacheEnded â†’ Data-Frames â†’ UpdateObjects | SegmentStartedAt â†’ Data-Room â†’ Data-Frames â†’ CacheEnded â†’ UpdateObjects | CacheEndedä½ç½®ä¸åŒ |
| **SegmentStartedAt** | 2025-07-31 11:20:00.753128 | +10ç§’é€’å¢ | ç²¾ç¡®çš„10ç§’é—´éš” |
| **Data-Room** | âœ… å®Œæ•´Roomä¿¡æ¯ | âœ… ç›¸åŒRoomä¿¡æ¯ | å†…å®¹å®Œå…¨ä¸€è‡´ |
| **CacheEndedä½ç½®** | ç¬¬3ä¸ªåŒ… (æ—©æœŸ) | å€’æ•°å‡ ä¸ªåŒ… (å»¶å) | å¤„ç†é¡ºåºä¼˜åŒ– |

#### å›æ”¾åˆ†ç‰‡å¸§å†…å®¹å¯¹æ¯”

| å¸§ç±»å‹ | åˆå§‹åˆ†ç‰‡ (00) | åç»­åˆ†ç‰‡ (01+) | ä¸šåŠ¡æ„ä¹‰ |
|--------|---------------|----------------|----------|
| **Roomå¸§æ•°é‡** | 2ä¸ª (0.1%) | 1ä¸ª (0.0%) | åˆå§‹åˆ†ç‰‡é‡å¤Roomä¿¡æ¯ |
| **InstantiateObject** | 55ä¸ª (2.0%) | 55ä¸ª (2.0%) | æ¯ä¸ªåˆ†ç‰‡éƒ½å®Œæ•´åˆå§‹åŒ–å¯¹è±¡ |
| **UpdateObject** | 2655ä¸ª (97.9%) | 2632-2669ä¸ª (97.9%) | ä¸»è¦æ•°æ®è½½è· |
| **Data-Framesä¸­Room** | âœ… åŒ…å«é¢å¤–Roomå¸§ | âŒ æ— é¢å¤–Roomå¸§ | åˆå§‹åˆ†ç‰‡å†—ä½™ä¿è¯ |

#### å›æ”¾åˆ†ç‰‡Targetç­–ç•¥å¯¹æ¯”

| Targetç±»å‹ | åˆå§‹åˆ†ç‰‡ (00) | åç»­åˆ†ç‰‡ (01+) |
|------------|---------------|----------------|
| **InstantiateObject Target** | RoomAll (å®Œæ•´æˆ¿é—´ID) | CurrentPlayer |
| **UpdateObject Target** | RoomAll (å®Œæ•´æˆ¿é—´ID) | RoomAll (å®Œæ•´æˆ¿é—´ID) |
| **Roomæ¶ˆæ¯Target** | RoomAll (å®Œæ•´æˆ¿é—´ID) | RoomAll (å®Œæ•´æˆ¿é—´ID) |

